import Head from 'next/head'
import EachData from '../components/EachData'
import Navbar from '../components/Navbar'

export default function Home(props) {
  return (
    <div>
      <Head>
        <title>LUX | online movies rating</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Navbar />
      <div className="mx-4 md:container md:mx-auto">
        <EachData data={props.popularMovies} title="Popular movies" />
        <EachData data={props.nowPlaying} title="Now Playing" />
        <EachData data={props.topRated} title="Top Rated" />
        <EachData data={props.upcommingMovies} title="Upcomming Movies" />
      </div>
    </div>
  )
}

export async function getServerSideProps() {
  const tr = await fetch("https://api.themoviedb.org/3/movie/top_rated?api_key=f52aa1a7c260685a467d566a4b94825f")
  const topRated = await tr.json()

  const np = await fetch("https://api.themoviedb.org/3/movie/now_playing?api_key=f52aa1a7c260685a467d566a4b94825f")
  const nowPlaying = await np.json()

  const pm = await fetch("https://api.themoviedb.org/3/movie/popular?api_key=f52aa1a7c260685a467d566a4b94825f")
  const popularMovies = await pm.json()

  const upcom = await fetch("https://api.themoviedb.org/3/movie/upcoming?api_key=f52aa1a7c260685a467d566a4b94825f")
  const upcommingMovies = await upcom.json()

  return {
    props: {
      topRated: topRated,
      nowPlaying: nowPlaying,
      popularMovies: popularMovies,
      upcommingMovies: upcommingMovies,
    }
  }
}
